{"version":3,"sources":["../../../assets/assets/main_Script.js"],"names":["cc","Class","extends","Component","properties","movePanel","Node","whitePrefab","Prefab","blackPrefab","initRow","initCol","_newTopRow","_curBottomRow","_curTouchRow","_startPosittion","onLoad","position","row","randomBlackCol","Math","floor","random","col","block","instantiate","getComponent","init","addChild","name","pMult","v2","move","movePosition","x","y","runAction","sequence","moveTo","callFunc","updateRender","bind","oldRow","getChildByName","removeFromParent"],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM,IADN;AAERC,qBAAaP,GAAGQ,MAFR;AAGRC,qBAAaT,GAAGQ,MAHR;AAIRE,iBAAS,CAJD;AAKRC,iBAAS,CALD;AAMRC,oBAAY,IANJ;AAORC,uBAAe,IAPP;AAQRC,sBAAc,CAAC,CARP;AASRC,yBAAiB;AATT,KAHP;;AAeLC,YAAQ,kBAAU;AACd;AACA,aAAKH,aAAL,GAAqB,CAArB;AACA,aAAKD,UAAL,GAAkB,CAAlB;AACA,aAAKG,eAAL,GAAuB,KAAKV,SAAL,CAAeY,QAAtC;;AAGA,aAAI,IAAIC,MAAM,CAAd,EAAiBA,MAAM,CAAvB,EAA0BA,KAA1B,EAAgC;AAC5B,gBAAIC,iBAAiBC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAArB;AACA,iBAAI,IAAIC,MAAM,CAAd,EAAiBA,MAAM,CAAvB,EAA0BA,KAA1B,EAAgC;AAC3B,oBAAIC,QAAQ,IAAZ;AACA,oBAAGL,kBAAkBI,GAArB,EAAyB;AACrBC,4BAAQxB,GAAGyB,WAAH,CAAe,KAAKhB,WAApB,CAAR;AACAe,0BAAME,YAAN,CAAmB,cAAnB,EAAmCC,IAAnC,CAAwC,OAAxC,EAAgD,IAAhD;AACH,iBAHD,MAGK;AACDH,4BAAQxB,GAAGyB,WAAH,CAAe,KAAKlB,WAApB,CAAR;AACAiB,0BAAME,YAAN,CAAmB,cAAnB,EAAmCC,IAAnC,CAAwC,OAAxC,EAAgD,IAAhD;AAEH;AACD,qBAAKtB,SAAL,CAAeuB,QAAf,CAAwBJ,KAAxB;AACAA,sBAAMK,IAAN,GAAaX,MAAM,GAAN,GAAYK,GAAzB;AACAC,sBAAMP,QAAN,GAAiBjB,GAAG8B,KAAH,CAAS9B,GAAG+B,EAAH,CAAMR,GAAN,EAAUL,GAAV,CAAT,EAAwB,GAAxB,CAAjB;AACJ;AACJ;;AAED;AACA;AACA;AACA;AACA;AACH,KA7CI;AA8CLc,UAAM,gBAAU;AACZ,YAAIC,eAAejC,GAAG+B,EAAH,CAAM,KAAKhB,eAAL,CAAqBmB,CAA3B,EAA8B,KAAKnB,eAAL,CAAqBoB,CAArB,GAAyB,CAAC,KAAKtB,aAAL,GAAqB,CAAtB,IAA2B,CAAC,GAAnF,CAAnB;;AAEA,aAAKR,SAAL,CAAe+B,SAAf,CAAyBpC,GAAGqC,QAAH,CACrBrC,GAAGsC,MAAH,CAAU,GAAV,EAAcL,YAAd,CADqB,EAErBjC,GAAGuC,QAAH,CAAY,KAAKC,YAAL,CAAkBC,IAAlB,CAAuB,IAAvB,CAAZ,CAFqB,CAAzB;AAIH,KArDI;;AAuDLD,kBAAe,wBAAU;AACjB,YAAItB,MAAM,KAAKN,UAAf;AACA,YAAIO,iBAAiBC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAArB;AACA,aAAI,IAAIC,MAAM,CAAd,EAAiBA,MAAM,CAAvB,EAA0BA,KAA1B,EAAgC;AAC3B,gBAAIC,QAAQ,IAAZ;AACA,gBAAGL,kBAAkBI,GAArB,EAAyB;AACrBC,wBAAQxB,GAAGyB,WAAH,CAAe,KAAKhB,WAApB,CAAR;AACAe,sBAAME,YAAN,CAAmB,cAAnB,EAAmCC,IAAnC,CAAwC,OAAxC,EAAgD,IAAhD;AACH,aAHD,MAGK;AACDH,wBAAQxB,GAAGyB,WAAH,CAAe,KAAKlB,WAApB,CAAR;AACAiB,sBAAME,YAAN,CAAmB,cAAnB,EAAmCC,IAAnC,CAAwC,OAAxC,EAAgD,IAAhD;AAEH;AACD,iBAAKtB,SAAL,CAAeuB,QAAf,CAAwBJ,KAAxB;AACAA,kBAAMK,IAAN,GAAaX,MAAM,GAAN,GAAYK,GAAzB;AACAC,kBAAMP,QAAN,GAAiBjB,GAAG8B,KAAH,CAAS9B,GAAG+B,EAAH,CAAMR,GAAN,EAAUL,GAAV,CAAT,EAAwB,GAAxB,CAAjB;AACJ;AACD;AACA,YAAIwB,SAAS,KAAK7B,aAAlB;AACA,aAAI,IAAIU,OAAM,CAAd,EAAkBA,OAAM,CAAxB,EAA4BA,MAA5B,EAAkC;AAC9B,iBAAKlB,SAAL,CAAesC,cAAf,CAA8BD,SAAS,GAAT,GAAenB,IAA7C,EAAkDqB,gBAAlD;AAEH;AACD,aAAK/B,aAAL;AACA,aAAKC,YAAL;AACA,aAAKF,UAAL;AACH;;AAjFA,CAAT","file":"main_Script.js","sourceRoot":"../../../assets","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/class/index.html\n// Learn Attribute:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/reference/attributes/index.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://www.cocos.com/docs/creator/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/editors_and_tools/creator-chapters/scripting/life-cycle-callbacks/index.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        movePanel: cc.Node,\n        whitePrefab: cc.Prefab,\n        blackPrefab: cc.Prefab,\n        initRow: 6,\n        initCol: 4,\n        _newTopRow: null,\n        _curBottomRow :null,\n        _curTouchRow: -1,\n        _startPosittion: null,\n    },\n\n    onLoad: function(){\n        //加载 填满屏幕中央\n        this._curBottomRow = 0;\n        this._newTopRow = 6;\n        this._startPosittion = this.movePanel.position;\n\n\n        for(let row = 0; row < 6; row++){\n            let randomBlackCol = Math.floor(Math.random() * 4);\n            for(let col = 0; col < 4; col++){\n                 let block = null;\n                 if(randomBlackCol == col){\n                     block = cc.instantiate(this.blackPrefab);\n                     block.getComponent(\"block_Script\").init(\"black\",this);\n                 }else{\n                     block = cc.instantiate(this.whitePrefab);\n                     block.getComponent(\"block_Script\").init(\"white\",this);\n\n                 }\n                 this.movePanel.addChild(block);\n                 block.name = row + \"#\" + col;\n                 block.position = cc.pMult(cc.v2(col,row),150);\n            }\n        }\n\n        //碰到黑块往下移动\n        //一行只有一个黑块\n        //一行有四个块\n        //触碰黑块的时候，回收最下面一行，生成最上面的一行\n        //触碰白块，游戏结束\n    },\n    move: function(){\n        let movePosition = cc.v2(this._startPosittion.x,(this._startPosittion.y + (this._curBottomRow + 1) * -150));\n\n        this.movePanel.runAction(cc.sequence(\n            cc.moveTo(0.3,movePosition),\n            cc.callFunc(this.updateRender.bind(this))\n        ))\n    },\n\n    updateRender : function(){\n            let row = this._newTopRow;\n            let randomBlackCol = Math.floor(Math.random() * 4);\n            for(let col = 0; col < 4; col++){\n                 let block = null;\n                 if(randomBlackCol == col){\n                     block = cc.instantiate(this.blackPrefab);\n                     block.getComponent(\"block_Script\").init(\"black\",this)\n                 }else{\n                     block = cc.instantiate(this.whitePrefab);\n                     block.getComponent(\"block_Script\").init(\"white\",this);\n\n                 }\n                 this.movePanel.addChild(block);\n                 block.name = row + \"#\" + col;\n                 block.position = cc.pMult(cc.v2(col,row),150);\n            }\n            //remove buttom row\n            let oldRow = this._curBottomRow;\n            for(let col = 0 ; col < 4 ; col++){\n                this.movePanel.getChildByName(oldRow + \"#\" + col).removeFromParent();\n\n            }\n            this._curBottomRow++;\n            this._curTouchRow++;\n            this._newTopRow++;\n        }\n        \n    \n    \n});\n"]}